# UI設計

本ドキュメントでは、主要な画面（教師向け／生徒向け／未ログイン向け）とコンポーネント構成、ナビゲーション、状態遷移を整理する。

## 1. 全体構成

- **共通ヘッダー**: ロゴ、ナビゲーション（公開授業一覧、ログイン/ダッシュボード）、ログイン状態の表示、ユーザーメニュー（プロフィール・ログアウト）。
- **サイドバー（ログイン時）**: 科目/授業一覧、学習進捗リンク、管理メニュー（教師のみ）。
- **レスポンシブ**: PCでは2カラム、モバイルではナビゲーションをドロワー化。

## 2. 教師向け画面

### 2.1 ダッシュボード
- **概要カード**: 現在の公開授業数、今月の学習ログ件数、小テスト実施件数。
- **最近の活動**: 最新のCSVインポート履歴、最近公開した授業。
- **生徒視点プレビュー**: 「生徒モードに切り替え」ボタンで、生徒ダッシュボードをそのまま表示。

### 2.2 科目/単元/授業管理
- **一覧テーブル**（タブ切り替え）
    - カラム: 名前、年度、公開状態、紐付け状況、更新日時、操作（編集/削除）。
- **詳細パネル**: 選択した科目/単元/授業の詳細とコンテンツ一覧。
- **モーダルフォーム**: 新規作成/編集用フォーム（名称、説明、公開状態、年度、並び順）。

### 2.3 コンテンツ編集（授業内）
- **コンテンツリスト**: 種別アイコン付きカード、ドラッグ&ドロップで並び替え。
- **個別編集フォーム**:
    - 動画: タイトル、YouTube URL、所要時間、公開状態、メモ。
    - 小テスト: タイトル、出題数、再受験許可、説明。
    - その他教材: タイトル、リンクURL、補足。
- **小テスト問題エディタ**:
    - 問題リスト（並び替え可能）。
    - 右側で選択中の問題詳細（問題文、選択肢、正解、難易度、タグ）。
    - 「プレビュー」ボタンで生徒側UIプレビューを表示。

### 2.4 CSV一括登録画面
- **タブ**: 生徒 / 科目 / 単元 / 授業 / コンテンツ。
- **テンプレートダウンロード**: ファイル名と説明。
- **アップロードフォーム**: ファイル選択 + 「アップロード」ボタン、進捗バー。
- **結果ログ**: 成功件数・エラー件数、エラーファイルダウンロードリンク。

### 2.5 学習状況確認
- **フィルタ**: 科目、単元、授業、年度、ユーザー。
- **グラフ/テーブル**:
    - 円グラフ: 完了済み vs 未完了動画。
    - 棒グラフ: 小テスト正答率推移。
    - テーブル: 生徒ごとの視聴時間、問題別正誤。
- **詳細ドロワー**: 生徒をクリックすると詳細ログを表示（視聴履歴、小テスト履歴）。

## 3. 生徒向け画面

### 3.1 生徒ダッシュボード
- **ヒーローセクション**: 「こんにちは、◯◯さん」＋今期の総学習時間。
- **進捗カード**: 科目ごとの進捗バー（完了コンテンツ数 / 全体）。
- **近日の授業**: 最近追加/未完了の授業カード。
- **通知/お知らせ**: 教師からのメッセージ（将来拡張用）。

### 3.2 授業一覧・詳細
- **一覧**: グリッドカード表示。フィルタ（科目、公開状態）。
- **詳細ページ**:
    - ヘッダー: 授業タイトル、単元、説明。
    - タブ: 「動画」「小テスト」「その他教材」。
    - 各タブでコンテンツカードを表示し、視聴状態や小テスト進捗をアイコンで表現。

### 3.3 動画再生ページ
- **プレイヤー**: YouTube iframe、再生タイマー表示。
- **メタ情報**: 視聴済みステータス、最終視聴日時、要点メモ。
- **操作**: 「視聴済みをリセット」（教師または本人が手動でリセットする場合）。

### 3.4 小テスト画面
- **開始画面**: テスト概要、出題数、注意事項。
- **問題表示**: 一問ずつまたは一度に表示（設定で切替）。上部に残り時間/進捗。
- **回答送信後**:
    - 正誤判定結果カード。
    - 各問題の正解/解説表示。
    - 再受験ボタン（許可されている場合）。

### 3.5 学習履歴
- **タイムライン**: 視聴/小テスト実行の履歴。
- **フィルタ**: 日付、科目、成果（動画/テスト）。
- **エクスポート**: PDF/CSVで自分の履歴をダウンロード（任意）。

## 4. 未ログイン向け画面

### 4.1 トップページ
- **主ビジュアル**: プロジェクト紹介、ログイン/新着授業の導線。
- **科目ハイライト**: 公開中の科目カード。
- **授業ピックアップ**: 公開授業の一部を表示、クリックで詳細へ。

### 4.2 授業詳細（公開モード）
- 生徒向け詳細と同一レイアウトだが、学習ログや小テストボタンはグレーアウトし、「ログインして記録する」ボタンを表示。

## 5. 共通コンポーネント

- **Breadcrumb**: 科目 > 単元 > 授業を表示、どの画面からも辿れる。
- **PublishStatusBadge**: 公開/非公開/下書きを色付きバッジで表示。
- **ProgressBar**: 動画視聴率、小テスト正答率などを共通コンポーネント化。
- **Tab + Table**: 管理画面のデータ一覧に利用。
- **Modal/Drawer**: フォームや詳細表示で利用。
- **Toast通知**: 成功/失敗メッセージ。

## 6. ステート/エラー設計

- **ローディング**: Skeleton UIを導入し、Firestoreからの取得待ちを表現。
- **空状態**: コンテンツがない場合のガイドメッセージ（例: 「まだ授業がありません。最初の授業を作成しましょう。」）。
- **エラー**:
    - 認証エラー: ログインページへ誘導。
    - Firestore読み込みエラー: リトライボタン表示。
    - CSVエラー: アップロードカード内で行番号/メッセージ表示。

## 7. アクセシビリティ

- キーボード操作に対応（フォーカスリング、ショートカット）。
- コントラスト比をWCAG 2.1 AA以上でデザイン。
- フォームラベルとエラーメッセージを明確に関連付け。

## 8. 教師の生徒UI確認フロー

- ヘッダーのユーザーメニューから「生徒モード」へ切り替え、市場画面をそのまま表示。
- 切り替え時にバナーを表示し、「現在教師アカウントで生徒画面を表示中。学習ログは教師IDで記録されます」と明示。
- 戻るボタンで教師ダッシュボードへ復帰。

## 9. 今後の拡張

- モバイルでのオフライン閲覧を見据えたダウンロードボタン。
- コミュニケーション機能（コメント/質問）のUI準備。
- 教師と生徒を統合した通知センター。
